<html><head><link rel="import" href="boot.html"><link rel="import" href="async.html"><link rel="import" href="debounce.html"><script>"use strict";!function(){function e(e){for(var t,n=l?["click"]:f,o=0;o<n.length;o++)t=n[o],e?document.addEventListener(t,p,!0):document.removeEventListener(t,p,!0)}function t(e){var t=e.type;if(-1===f.indexOf(t))return!1;if("mousemove"===t){var n=void 0===e.buttons?1:e.buttons;return e instanceof window.MouseEvent&&!d&&(n=h[e.which]||0),Boolean(1&n)}return 0===(void 0===e.button?0:e.button)}function n(e){if("click"===e.type){if(0===e.detail)return!0;var t=y._findOriginalTarget(e);if(!t.nodeType||t.nodeType!==Node.ELEMENT_NODE)return!0;var n=t.getBoundingClientRect(),o=e.pageX,i=e.pageY;return!(o>=n.left&&o<=n.right&&i>=n.top&&i<=n.bottom)}return!1}function o(e){var t="auto",n=e.composedPath&&e.composedPath();if(n)for(var o,i=0;i<n.length;i++)if((o=n[i])[c]){t=o[c];break}return t}function i(e,t,n){e.movefn=t,e.upfn=n,document.addEventListener("mousemove",t),document.addEventListener("mouseup",n)}function r(e){document.removeEventListener("mousemove",e.movefn),document.removeEventListener("mouseup",e.upfn),e.movefn=null,e.upfn=null}var s="string"==typeof document.head.style.touchAction,u="__polymerGesturesHandled",c="__polymerGesturesTouchAction",a=2500,f=["mousedown","mousemove","mouseup","click"],h=[0,1,4,2],d=function(){try{return 1===new MouseEvent("test",{buttons:1}).buttons}catch(e){return!1}}(),v=!1;!function(){try{var e=Object.defineProperty({},"passive",{get:function(){v=!0}});window.addEventListener("test",null,e),window.removeEventListener("test",null,e)}catch(e){}}();var l=navigator.userAgent.match(/iP(?:[oa]d|hone)|Android/),m=function(){};m.prototype.reset=function(){},m.prototype.mousedown,m.prototype.mousemove,m.prototype.mouseup,m.prototype.touchstart,m.prototype.touchmove,m.prototype.touchend,m.prototype.click;var p=function(e){var t=e.sourceCapabilities;if((!t||t.firesTouchEvents)&&(e[u]={skip:!0},"click"===e.type)){var n=e.composedPath&&e.composedPath();if(n)for(var o=0;o<n.length;o++)if(n[o]===g.mouse.target)return;e.preventDefault(),e.stopPropagation()}},g={mouse:{target:null,mouseIgnoreJob:null},touch:{x:0,y:0,id:-1,scrollDecided:!1}};document.addEventListener("touchend",function(t){g.mouse.mouseIgnoreJob||e(!0);g.mouse.target=t.composedPath()[0],g.mouse.mouseIgnoreJob=Polymer.Debouncer.debounce(g.mouse.mouseIgnoreJob,Polymer.Async.timeOut.after(a),function(){e(),g.mouse.target=null,g.mouse.mouseIgnoreJob=null})},!!v&&{passive:!0});var y={gestures:{},recognizers:[],deepTargetFind:function(e,t){for(var n=document.elementFromPoint(e,t),o=n;o&&o.shadowRoot&&!window.ShadyDOM;){var i=o;if(o=o.shadowRoot.elementFromPoint(e,t),i===o)break;o&&(n=o)}return n},_findOriginalTarget:function(e){return e.composedPath?e.composedPath()[0]:e.target},_handleNative:function(e){var t=void 0,n=e.type,o=e.currentTarget.__polymerGestures;if(o){var i=o[n];if(i){if(!e[u]&&(e[u]={},"touch"===n.slice(0,5))){var r=(e=e).changedTouches[0];if("touchstart"===n&&1===e.touches.length&&(g.touch.id=r.identifier),g.touch.id!==r.identifier)return;s||"touchstart"!==n&&"touchmove"!==n||y._handleTouchAction(e)}if(!(t=e[u]).skip){for(var c,a=y.recognizers,f=0;f<a.length;f++)i[(c=a[f]).name]&&!t[c.name]&&c.flow&&c.flow.start.indexOf(e.type)>-1&&c.reset&&c.reset();for(var h,d=0;d<a.length;d++)i[(h=a[d]).name]&&!t[h.name]&&(t[h.name]=!0,h[n](e))}}}},_handleTouchAction:function(e){var t=e.changedTouches[0],n=e.type;if("touchstart"===n)g.touch.x=t.clientX,g.touch.y=t.clientY,g.touch.scrollDecided=!1;else if("touchmove"===n){if(g.touch.scrollDecided)return;g.touch.scrollDecided=!0;var i=o(e),r=!1,s=Math.abs(g.touch.x-t.clientX),u=Math.abs(g.touch.y-t.clientY);e.cancelable&&("none"===i?r=!0:"pan-x"===i?r=u>s:"pan-y"===i&&(r=s>u)),r?e.preventDefault():y.prevent("track")}},addListener:function(e,t,n){return!!this.gestures[t]&&(this._add(e,t,n),!0)},removeListener:function(e,t,n){return!!this.gestures[t]&&(this._remove(e,t,n),!0)},_add:function(e,t,n){var o=this.gestures[t],i=o.deps,r=o.name,s=e.__polymerGestures;s||(e.__polymerGestures=s={});for(var u,c,a=0;a<i.length;a++)u=i[a],l&&f.indexOf(u)>-1&&"click"!==u||((c=s[u])||(s[u]=c={_count:0}),0===c._count&&e.addEventListener(u,this._handleNative),c[r]=(c[r]||0)+1,c._count=(c._count||0)+1);e.addEventListener(t,n),o.touchAction&&this.setTouchAction(e,o.touchAction)},_remove:function(e,t,n){var o=this.gestures[t],i=o.deps,r=o.name,s=e.__polymerGestures;if(s)for(var u,c,a=0;a<i.length;a++)(c=s[u=i[a]])&&c[r]&&(c[r]=(c[r]||1)-1,c._count=(c._count||1)-1,0===c._count&&e.removeEventListener(u,this._handleNative));e.removeEventListener(t,n)},register:function(e){this.recognizers.push(e);for(var t=0;t<e.emits.length;t++)this.gestures[e.emits[t]]=e},_findRecognizerByEvent:function(e){for(var t,n=0;n<this.recognizers.length;n++){t=this.recognizers[n];for(var o=0;o<t.emits.length;o++)if(t.emits[o]===e)return t}return null},setTouchAction:function(e,t){s&&(e.style.touchAction=t),e[c]=t},_fire:function(e,t,n){var o=new Event(t,{bubbles:!0,cancelable:!0,composed:!0});if(o.detail=n,e.dispatchEvent(o),o.defaultPrevented){var i=n.preventer||n.sourceEvent;i&&i.preventDefault&&i.preventDefault()}},prevent:function(e){var t=this._findRecognizerByEvent(e);t.info&&(t.info.prevent=!0)},resetMouseCanceller:function(){g.mouse.mouseIgnoreJob&&g.mouse.mouseIgnoreJob.flush()}};y.register({name:"downup",deps:["mousedown","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["down","up"],info:{movefn:null,upfn:null},reset:function(){r(this.info)},mousedown:function(e){if(t(e)){var n=y._findOriginalTarget(e),o=this;i(this.info,function(e){t(e)||(o._fire("up",n,e),r(o.info))},function(e){t(e)&&o._fire("up",n,e),r(o.info)}),this._fire("down",n,e)}},touchstart:function(e){this._fire("down",y._findOriginalTarget(e),e.changedTouches[0],e)},touchend:function(e){this._fire("up",y._findOriginalTarget(e),e.changedTouches[0],e)},_fire:function(e,t,n,o){y._fire(t,e,{x:n.clientX,y:n.clientY,sourceEvent:n,preventer:o,prevent:function(e){return y.prevent(e)}})}}),y.register({name:"track",touchAction:"none",deps:["mousedown","touchstart","touchmove","touchend"],flow:{start:["mousedown","touchstart"],end:["mouseup","touchend"]},emits:["track"],info:{x:0,y:0,state:"start",started:!1,moves:[],addMove:function(e){this.moves.length>2&&this.moves.shift(),this.moves.push(e)},movefn:null,upfn:null,prevent:!1},reset:function(){this.info.state="start",this.info.started=!1,this.info.moves=[],this.info.x=0,this.info.y=0,this.info.prevent=!1,r(this.info)},hasMovedEnough:function(e,t){if(this.info.prevent)return!1;if(this.info.started)return!0;var n=Math.abs(this.info.x-e),o=Math.abs(this.info.y-t);return n>=5||o>=5},mousedown:function(e){if(t(e)){var n=y._findOriginalTarget(e),o=this,s=function(e){var i=e.clientX,s=e.clientY;o.hasMovedEnough(i,s)&&(o.info.state=o.info.started?"mouseup"===e.type?"end":"track":"start","start"===o.info.state&&y.prevent("tap"),o.info.addMove({x:i,y:s}),t(e)||(o.info.state="end",r(o.info)),o._fire(n,e),o.info.started=!0)};i(this.info,s,function(e){o.info.started&&s(e),r(o.info)}),this.info.x=e.clientX,this.info.y=e.clientY}},touchstart:function(e){var t=e.changedTouches[0];this.info.x=t.clientX,this.info.y=t.clientY},touchmove:function(e){var t=y._findOriginalTarget(e),n=e.changedTouches[0],o=n.clientX,i=n.clientY;this.hasMovedEnough(o,i)&&("start"===this.info.state&&y.prevent("tap"),this.info.addMove({x:o,y:i}),this._fire(t,n),this.info.state="track",this.info.started=!0)},touchend:function(e){var t=y._findOriginalTarget(e),n=e.changedTouches[0];this.info.started&&(this.info.state="end",this.info.addMove({x:n.clientX,y:n.clientY}),this._fire(t,n,e))},_fire:function(e,t){var n=this.info.moves[this.info.moves.length-2],o=this.info.moves[this.info.moves.length-1],i=o.x-this.info.x,r=o.y-this.info.y,s=void 0,u=0;n&&(s=o.x-n.x,u=o.y-n.y),y._fire(e,"track",{state:this.info.state,x:t.clientX,y:t.clientY,dx:i,dy:r,ddx:s,ddy:u,sourceEvent:t,hover:function(){return y.deepTargetFind(t.clientX,t.clientY)}})}}),y.register({name:"tap",deps:["mousedown","click","touchstart","touchend"],flow:{start:["mousedown","touchstart"],end:["click","touchend"]},emits:["tap"],info:{x:NaN,y:NaN,prevent:!1},reset:function(){this.info.x=NaN,this.info.y=NaN,this.info.prevent=!1},save:function(e){this.info.x=e.clientX,this.info.y=e.clientY},mousedown:function(e){t(e)&&this.save(e)},click:function(e){t(e)&&this.forward(e)},touchstart:function(e){this.save(e.changedTouches[0],e)},touchend:function(e){this.forward(e.changedTouches[0],e)},forward:function(e,t){var o=Math.abs(e.clientX-this.info.x),i=Math.abs(e.clientY-this.info.y),r=y._findOriginalTarget(e);(isNaN(o)||isNaN(i)||o<=25&&i<=25||n(e))&&(this.info.prevent||y._fire(r,"tap",{x:e.clientX,y:e.clientY,sourceEvent:e,preventer:t}))}}),y.findOriginalTarget=y._findOriginalTarget,y.add=y.addListener,y.remove=y.removeListener,Polymer.Gestures=y}();</script></head><body></body></html>